# デリモン - 要件定義書（プロフィール設定追加版）

**バージョン**: 1.1  
**最終更新日**: 2025年11月6日  
**作成者**: [名前]  
**ステータス**: 設計中

---

## 変更履歴

| 日付 | バージョン | 変更内容 | 担当者 |
|------|-----------|---------|--------|
| 2025-11-06 | 1.1 | プロフィール設定機能を追加 | [名前] |
| 2025-11-06 | 1.0 | 初版作成 | [名前] |

---

## 1. プロジェクト概要

### 1.1 アプリ名
**デリモン（Delivery Monsters）**

### 1.2 目的
配送業務やドライブなど、日々の移動をゲーム化し、モンスター育成を通じて移動のモチベーションを高める。特に配送ドライバーなど移動が多い職業の人に、仕事の楽しみを提供する。

### 1.3 解決したい課題
- 配送業務の単調さ、モチベーション維持の難しさ
- 長距離移動の退屈さ
- 日々の移動距離・頑張りの可視化不足

### 1.4 ターゲットユーザー

**メインターゲット**:
- 運送業者・宅配業者のドライバー
- ウーバーイーツ・出前館などフードデリバリー配達員
- 年齢層: 20代〜50代
- 全国で約84万人

**サブターゲット**:
- 営業職など移動が多い職業の人
- タクシードライバー
- ドライブ好き、ゲーム好きな一般ユーザー

### 1.5 想定規模

**MVP（Phase 1）**:
- 初月: 100〜500人
- 3ヶ月後: 1,000〜3,000人
- 目標: 最初の3ヶ月で安定した継続率30%以上

**最終目標（Phase 2〜3）**:
- 1年後: 10,000人
- 3年後: 100,000人（全ドライバーの約12%）

---

## 2. MVP機能（Phase 1）

### 2.1 認証機能
- メールアドレス + パスワードでのサインアップ
- ログイン
- ログアウト
- **プロフィール設定（初回登録時）** ⭐NEW
  - ニックネーム
  - 生年月日
  - 性別
  - 業種

### 2.2 チュートリアル機能
- 初回起動時のチュートリアル（4画面）
- キャラクター選択（3種類から1体選択）

### 2.3 キャラクター育成機能
- 相棒キャラクター表示
- レベル・経験値システム
- 進化機能（2段階進化）
  - レベル20: 2段階目進化
  - レベル50: 3段階目進化
- 進化アニメーション

### 2.4 GPS計測機能
- 配送開始・終了ボタン
- リアルタイム移動距離計測
- 移動軌跡の地図表示
- バックグラウンドでの位置情報トラッキング

### 2.5 経験値・レベルシステム
- 移動距離に応じた経験値獲得（1km = 100経験値）
- レベルアップ（1レベルアップ = 10km = 1,000経験値）
- レベル上限なし（MVP）

### 2.6 図鑑機能
- 相棒キャラクターの表示
- その他のキャラクターはシルエット表示（未取得）
- 合計9体（3種類 × 3段階進化）

### 2.7 履歴機能
- 配送履歴の一覧表示
- 期間別統計（今週・今月・全期間）
- 走行距離グラフ

### 2.8 設定機能
- **プロフィール編集** ⭐NEW
  - ニックネーム変更
  - 生年月日変更
  - 性別変更
  - 業種変更
- 通知設定
- データ収集設定
- プライバシーポリシー・利用規約表示
- アカウント削除
- ログアウト

### 2.9 プッシュ通知
- レベルアップ通知
- 進化可能通知

---

## 3. MVP除外機能（将来実装）

### 3.1 Phase 2で実装予定
- 複数キャラクター育成
- ガチャ機能
- 課金システム
- ランキング機能
- すれ違い通信
- 日報作成機能

### 3.2 Phase 3で実装予定
- SNS機能（投稿・コメント）
- 対戦機能
- フレンド機能
- チーム・ギルド機能

---

## 4. ユーザーストーリー

### 4.1 初回ユーザー（プロフィール設定含む） ⭐UPDATED

**ストーリー**:
> 配送ドライバーの田中さん（30歳男性、トラックドライバー）は、友人の紹介でデリモンをダウンロード。アプリを起動すると、まず3種類のキャラクターから「ハコブー」を選択。チュートリアルで使い方を確認した後、メールアドレスでアカウントを作成。**プロフィール設定画面でニックネーム「たなか」、生年月日、性別「男」、業種「トラックドライバー」を入力。**その後、ホーム画面に進み、相棒のハコブーが表示された。

**ユーザーの感情**:
- ワクワク: どんなキャラクターか楽しみ
- 安心: 短いチュートリアルでわかりやすい
- **自然: プロフィール設定が簡単で入力しやすい** ⭐NEW

### 4.2 日常的な利用

**ストーリー**:
> 田中さんは朝、配送を開始する前に「配送を開始」ボタンをタップ。1日の配送が終わり「配送を終了」ボタンを押すと、走行距離45kmが表示され、経験値+4,500を獲得。ハコブーがレベル3からレベル7にアップ！夜、履歴画面で今週の走行距離を確認し、「今週は250km走ったんだ」と実感。

**ユーザーの感情**:
- 達成感: 移動距離が可視化されて嬉しい
- 楽しさ: キャラクターが成長する喜び
- モチベーション向上: 明日も頑張ろうと思える

### 4.3 進化の瞬間

**ストーリー**:
> 2週間後、田中さんのハコブーがレベル20に到達。配送終了後の結果画面で「進化できます！」と表示され、「進化を見る」ボタンをタップ。アニメーションとともにハコブーが「ハコドン」に進化！「おお！」と思わず声が出た。

**ユーザーの感情**:
- 興奮: 進化の演出がかっこいい
- 愛着: 相棒が強くなった喜び
- 継続意欲: 次の進化も見たい

### 4.4 プロフィール編集 ⭐NEW

**ストーリー**:
> 田中さんは転職して軽貨物ドライバーになった。設定メニューから「プロフィール編集」を開き、業種を「トラックドライバー」から「軽貨物ドライバー」に変更。ニックネームも「たなか#1234」から「Tanaka#1234」に変更したかったが、表示されている「#1234」は変更できないことを確認。「たなか」の部分だけを「Tanaka」に変更して保存完了。

**ユーザーの感情**:
- 便利: 簡単にプロフィールを更新できた
- 安心: 識別番号は変わらないので、ランキングでの識別が継続

---

## 5. プロフィール設定の詳細仕様 ⭐NEW

### 5.1 プロフィール設定項目

| 項目 | 必須 | 公開範囲 | 変更可能 | 備考 |
|------|------|---------|---------|------|
| ニックネーム | ○ | 公開 | ○ | 2〜20文字、識別番号は自動付与 |
| 生年月日 | ○ | 非公開 | ○ | 誕生月イベント用 |
| 性別 | ○ | 非公開 | ○ | 統計分析用 |
| 業種 | ○ | 非公開 | ○ | 統計分析用 |

### 5.2 ニックネーム仕様

**表示形式**:
- ユーザーが入力: 「たなか」
- システムが自動付与: 4桁の識別番号「#1234」
- 最終表示: 「たなか#1234」

**制約**:
- 文字数: 2〜20文字
- 使用可能文字: 日本語、英数字、アンダーバー(_)、ハイフン(-)
- 特殊文字禁止: @#$%など
- 識別番号: 0001〜9999（ランダム生成）
- 重複: ニックネーム部分は重複可能、識別番号で一意性を確保

**データベース保存**:
```sql
nickname: 'たなか'        -- ユーザー入力部分
display_id: '1234'        -- 4桁の識別番号
表示時: nickname + '#' + display_id
```

### 5.3 生年月日仕様

**入力形式**:
- 年: 4桁の数字入力（例: 1990）
- 月: 2桁の数字入力（例: 06）
- 日: 2桁の数字入力（例: 25）

**制約**:
- 年: 1900〜2025
- 月: 1〜12
- 日: 1〜31（月に応じて妥当性チェック）
- 閏年考慮あり

**用途**:
- 統計分析（年齢層データ）
- 将来の誕生月イベント
  - 誕生月にログイン: 特別ボーナス
  - 誕生日当日: 「お誕生日おめでとう！」メッセージ

**データベース保存**:
- DATE型として保存
- 例: `1990-06-25`

### 5.4 性別仕様

**選択肢**:
- 男
- 女
- 答えたくない

**用途**:
- 統計分析のみ
- ユーザー体験には影響なし

**データベース保存**:
- ENUM型: `male`, `female`, `prefer_not_to_say`

### 5.5 業種仕様

**選択肢**:
- トラックドライバー
- 軽貨物ドライバー
- フードデリバリー
- 貨物船
- バス・タクシー
- その他

**用途**:
- 統計分析のみ
- 将来的に業種別ランキング実装の可能性

**データベース保存**:
- ENUM型: `truck_driver`, `light_vehicle_driver`, `food_delivery`, `cargo_ship`, `bus_taxi`, `other`

### 5.6 プロフィール編集機能

**編集可能項目**:
- すべての項目が後から編集可能
- ただし、ニックネームの識別番号(#1234)は変更不可

**変更検知**:
- 入力内容に変更がある場合のみ保存ボタン有効化
- 変更なしで戻る: 確認ダイアログなし
- 変更ありで戻る: 「変更を破棄しますか？」確認ダイアログ

**アクセス**:
- 設定メニュー → プロフィール編集

---

## 6. 機能要件

### 6.1 認証機能

**サインアップ**:
- メールアドレス形式チェック
- パスワード要件: 8文字以上、英数字混在
- パスワード確認フィールド（一致チェック）
- データ収集同意チェックボックス（必須）
- **サインアップ後、プロフィール設定画面へ自動遷移** ⭐NEW

**ログイン**:
- メールアドレス + パスワード
- セッション管理（Supabase Auth）
- 「初めての方はこちら」リンク → キャラクター選択画面

**ログアウト**:
- 確認ダイアログ表示
- セッション削除

### 6.2 プロフィール設定機能 ⭐NEW

**初回設定（必須）**:
- サインアップ直後に表示
- すべての項目が必須入力
- 完了するまでホーム画面に進めない
- リアルタイムバリデーション表示

**プロフィール編集（任意）**:
- 設定メニューからアクセス
- すべての項目が編集可能
- 変更検知機能
- 保存成功メッセージ表示

**バリデーション**:
- ニックネーム: 2〜20文字、特殊文字禁止
- 生年月日: 妥当な日付、閏年考慮
- 性別: 3択から選択必須
- 業種: 6択から選択必須

**エラーハンドリング**:
- バリデーションエラー: フィールド下にエラーメッセージ
- 保存失敗: 「保存に失敗しました」ダイアログ
- ネットワークエラー: リトライ機能

### 6.3 チュートリアル機能

**キャラクター選択**:
- 3種類のキャラクター表示
  - ハコブー（箱型、バランス型）
  - ルートン（ルート型、スピード型）
  - シールン（シール型、パワー型）
- 各キャラクターの簡単な説明
- 一度選んだら変更不可（MVP）
- **選択後、チュートリアルへ遷移** ⭐UPDATED

**チュートリアル**:
- 4画面のスライド形式
- スワイプで次へ
- インジケーター表示（●●○○）
- スキップ不可
- 最後の画面: 「アカウント登録」ボタン → サインアップ画面

### 6.4 キャラクター育成機能

**相棒キャラクター**:
- 1体のみ（MVP）
- レベル表示
- 経験値バー表示
- 進化段階に応じた画像変化

**レベルシステム**:
- 1レベル = 1,000経験値 = 10km
- レベル上限なし
- レベルアップ時: 光のエフェクト

**進化システム**:
- レベル20: 2段階目進化
- レベル50: 3段階目進化
- 進化時: 専用アニメーション画面（約6秒）
- スキップ不可

### 6.5 GPS計測機能

**配送開始**:
- GPS権限チェック
- 位置情報トラッキング開始
- スタート地点記録
- 配送中状態に切り替え

**配送中**:
- リアルタイム位置情報取得（5秒間隔）
- 移動距離計算（座標間の距離を合算）
- 移動軌跡の地図表示
- バックグラウンドトラッキング対応
- 通知表示: 「配送中: 12.5km」

**配送終了**:
- 確認ダイアログ表示
- トラッキング停止
- 配送データ保存
- 配送結果画面表示

**GPS精度**:
- 精度: ±10m程度
- 建物内・トンネルでの誤差を考慮
- GPS信号弱い場合: 警告表示

### 6.6 経験値・レベルシステム

**経験値計算**:
```
獲得経験値 = 移動距離(km) × 100
例: 12.5km → 1,250経験値
```

**レベルアップ判定**:
```
レベル2に必要な経験値: 1,000
レベル3に必要な経験値: 1,000
...
常に1,000経験値でレベルアップ
```

**累計経験値**:
```
レベル20到達: 20,000経験値 = 200km
レベル50到達: 50,000経験値 = 500km
```

### 6.7 図鑑機能

**表示内容**:
- 相棒キャラクター: カラー画像、レベル表示、「相棒」バッジ
- その他8体: シルエット、「???」、「未取得」
- 収集率: 「1 / 9体」

**キャラクター詳細**（タップ時）:
- キャラクター画像
- 名前、レベル
- 現在の経験値
- 進化系統図
- 図鑑説明文

### 6.8 履歴機能

**表示内容**:
- 期間選択: 今週・今月・全期間
- 統計カード:
  - 合計走行距離
  - 配送回数
  - 獲得経験値
- 配送履歴リスト:
  - 日付・時刻
  - 走行距離
  - 走行時間
  - 獲得経験値
  - 進化アイコン（進化時）

**詳細表示**（タップ時）:
- 地図（ルート表示）
- 詳細情報

**データ保存**:
- セッション単位で保存
- 座標データは保存しない（MVPでは集約のみ）

### 6.9 設定機能

**設定項目**:
- **プロフィール編集** ⭐NEW
- 通知設定:
  - 配送リマインダー（ON/OFF）
  - レベルアップ通知（ON/OFF）
- 地図設定:
  - 地図タイプ（標準/衛星/地形）
- データ収集設定:
  - 位置情報の収集（ON/OFF）
  - 使用統計の送信（ON/OFF）
- プライバシーポリシー
- 利用規約
- アカウント削除
- ログアウト

**プライバシーポリシー更新** ⭐NEW:
- プロフィール情報の収集と利用について明記
- 公開範囲の説明（ニックネームのみ公開）
- 誕生月イベントでの利用について記載

### 6.10 プッシュ通知

**通知種類**:
- レベルアップ: 「おめでとう！レベル5になりました！」
- 進化可能: 「ハコブーが進化できます！」

**通知設定**:
- 設定画面でON/OFF切り替え可能

---

## 7. 非機能要件

### 7.1 パフォーマンス
- 画面遷移: 500ms以内
- GPS位置情報取得: 5秒間隔
- バッテリー消費: バックグラウンドGPS使用時、1時間で5%以内

### 7.2 セキュリティ
- パスワード: ハッシュ化して保存
- HTTPS通信
- **個人情報保護**: プロフィール情報（生年月日、性別、業種）は非公開 ⭐NEW
- **ニックネームのみ公開**: 識別番号付き ⭐NEW

### 7.3 可用性
- 稼働率: 99%以上
- ダウンタイム: 月1回、30分以内のメンテナンス

### 7.4 互換性
- Android: 8.0以上
- iOS: 13.0以上

### 7.5 データ保存
- Supabase無料枠: 500MB
- 想定データ量（1,000ユーザー × 3ヶ月）:
  - ユーザー情報: 約1MB（プロフィール含む） ⭐UPDATED
  - 配送履歴: 約50MB
  - 合計: 約51MB → 無料枠内で十分

---

## 8. 画面構成（概要）

※詳細はサイトマップ・画面遷移図を参照

### 認証系
- スプラッシュ画面
- チュートリアル画面（4画面）
- キャラクター選択画面
- ログイン画面
- サインアップ画面
- **プロフィール設定画面** ⭐NEW

### メイン機能系（タブ）
- ホーム画面（相棒キャラクター表示）
- 配送画面（地図表示、距離計測）
- 図鑑画面（所持モンスター一覧）
- 履歴画面（走行距離グラフ、統計）

### 設定系
- 設定画面
- **プロフィール編集画面** ⭐NEW
- プライバシーポリシー画面
- 利用規約画面

### その他
- 進化アニメーション画面
- 配送結果画面

**想定画面数**: **17画面**（プロフィール設定・編集の2画面追加） ⭐NEW

---

## 9. 開発スケジュール（目安）

| フェーズ | 期間 | 内容 |
|---------|------|------|
| 要件定義・設計 | 1週間 | 要件定義、アーキテクチャ設計、DB設計、API設計 |
| 環境構築 | 3日 | React Native、Supabaseセットアップ |
| 認証実装 | 1週間 | ログイン、サインアップ |
| **プロフィール設定実装** | **3日** | **初回設定・編集画面** ⭐NEW |
| チュートリアル・キャラ選択 | 3日 | UI実装 |
| GPS計測機能 | 2週間 | 最も重要で時間がかかる部分 |
| 経験値・レベルシステム | 1週間 | ロジック実装 |
| 図鑑・履歴画面 | 1週間 | UI + グラフ表示 |
| プッシュ通知 | 3日 | FCM連携 |
| 設定機能 | 3日 | 各種設定項目 |
| テスト・バグ修正 | 1週間 | 実地テスト含む |
| ストア申請準備 | 3日 | スクリーンショット、説明文など |
| **合計** | **約8.5週間（2ヶ月強）** | **MVP完成まで** ⭐UPDATED |

---

## 10. 成功指標（KPI）

### リリース1ヶ月目
- **ダウンロード数**: 100〜500人
- **DAU（Daily Active Users）**: 50〜200人
- **プロフィール設定完了率**: 95%以上 ⭐NEW

### リリース3ヶ月目
- **ダウンロード数**: 1,000〜3,000人
- **30日継続率**: 30%以上
- **1日あたりの平均移動距離**: 20km以上

### 主要指標
- **最重視**: 継続率（ユーザーの定着）
- **副次的**: DAU/MAU、1日あたりの平均移動距離
- **ユーザー満足度**: プロフィール編集機能の利用率 ⭐NEW

---

## 11. リスクと対策

### 11.1 技術リスク

**GPS精度の問題**:
- リスク: 建物内・トンネルでGPS信号が弱い
- 対策: GPS信号弱い場合の警告表示、誤差を許容する設計

**バッテリー消費**:
- リスク: バックグラウンドGPS使用によるバッテリー消費
- 対策: 位置情報取得間隔を5秒に設定、最適化

**データ容量**:
- リスク: 配送履歴データの増加
- 対策: MVPでは座標データを保存しない、集約データのみ保存

### 11.2 ユーザー体験リスク

**複雑すぎるUI**:
- リスク: 機能が多すぎて使いにくい
- 対策: MVPで機能を絞る、シンプルなUI設計

**モチベーション維持の難しさ**:
- リスク: 最初は楽しいが飽きる
- 対策: 進化システム、**誕生月イベント（将来実装）** ⭐NEW、定期的なアップデート

**プロフィール入力の煩わしさ** ⭐NEW:
- リスク: 初回登録時のプロフィール入力が面倒で離脱
- 対策: 入力項目を最小限に、リアルタイムバリデーションで入力ミス防止

### 11.3 ビジネスリスク

**ターゲットユーザーへのリーチ**:
- リスク: ドライバーにアプリを知ってもらえない
- 対策: SNS広告、ドライバー向けメディア・コミュニティでのPR

**競合の出現**:
- リスク: 類似アプリが出る
- 対策: 早期リリース、ユーザーフィードバックを活かした改善

---

## 12. データ分析・統計活用 ⭐NEW

### 12.1 収集するプロフィールデータ

**目的**: サービス改善、マーケティング戦略立案

**収集項目**:
- 年齢層（生年月日から算出）
- 性別
- 業種

### 12.2 分析内容

**ユーザー属性分析**:
- 年齢層別の利用率
- 性別別の利用傾向
- 業種別の平均走行距離

**例**:
```
トラックドライバー: 平均50km/日
軽貨物ドライバー: 平均30km/日
フードデリバリー: 平均15km/日
```

**活用方法**:
- 業種別のターゲットマーケティング
- 業種に応じた機能開発（例: トラックドライバー向けの長距離ボーナス）
- ユーザーの声を集める際のセグメント化

### 12.3 将来の統計機能

**Phase 2以降で検討**:
- 業種別ランキング
- 年齢層別ランキング
- 地域別統計（都道府県レベル）

**プライバシー配慮**:
- 統計データは匿名化
- 個人を特定できる形での公開は行わない

---

## 13. プライバシーポリシー・利用規約への追記 ⭐NEW

### 13.1 プライバシーポリシーに追記する内容

**収集する情報**:
- プロフィール情報（ニックネーム、生年月日、性別、業種）

**情報の利用目的**:
- サービス提供（ニックネーム表示）
- 統計分析（年齢層、性別、業種）
- 誕生月イベントの提供（将来機能）

**情報の公開範囲**:
- 公開: ニックネーム（識別番号付き）
- 非公開: 生年月日、性別、業種

**ユーザーの権利**:
- プロフィール編集の権利
- データ削除の権利（アカウント削除）

### 13.2 利用規約に追記する内容

**アカウント管理**:
- プロフィール情報の正確性（虚偽情報の禁止）
- ニックネームの適切性（他者を誹謗中傷する名前の禁止）

**禁止事項**:
- 不適切なニックネーム（差別的、わいせつ、誹謗中傷など）
- 他人になりすますニックネーム

---

## 14. まとめ

### 14.1 MVP範囲の明確化

**含まれるもの**:
- 認証（ログイン・サインアップ）
- **プロフィール設定・編集** ⭐NEW
- チュートリアル・キャラクター選択
- GPS計測
- 経験値・レベルシステム
- 進化機能
- 図鑑（相棒のみ）
- 履歴
- 設定
- プッシュ通知

**含まれないもの（Phase 2以降）**:
- 複数キャラクター育成
- ガチャ
- 課金
- ランキング
- SNS機能
- 対戦機能

### 14.2 開発の優先順位

**最優先**:
1. GPS計測機能（コア機能）
2. 経験値・レベルシステム
3. 認証機能

**次に重要**:
4. **プロフィール設定・編集** ⭐NEW
5. チュートリアル
6. 進化機能
7. 図鑑・履歴

**最後**:
8. プッシュ通知
9. 細かいUI調整

---

## 15. 次のステップ

1. ✅ **要件定義書の承認**（本ドキュメント） ⭐UPDATED
2. アーキテクチャ設計書の作成
3. **データベース設計書の作成（プロフィールテーブル追加）** ⭐UPDATED
4. API設計書の作成
5. サイトマップ・画面遷移図の作成
6. 開発環境構築
7. 実装開始

---

以上
