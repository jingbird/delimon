# Issue #17: スプラッシュ画面・画面遷移ロジックの実装

### 背景 / 目的
アプリ起動時にセッション確認・プロフィール設定済みチェックを行い、適切な画面へ遷移するロジックを実装する。

- **依存**: #14, #16
- **ラベル**: `frontend`, `feature`

---

### スコープ / 作業項目

#### 1. スプラッシュ画面の作成
- `app/index.tsx` または `app/_layout.tsx` でスプラッシュ画面を表示
- expo-splash-screenを使用して1〜3秒表示
- デリモンのロゴ・アプリ名を表示

#### 2. セッション確認ロジック
- Supabase Authのセッション確認を実施
- `supabase.auth.getSession()` でログイン状態を確認

#### 3. プロフィール設定済みチェック
- `users` テーブルから `nickname`, `birth_date`, `gender`, `occupation` を取得
- すべて入力済みの場合は「プロフィール設定済み」と判定

#### 4. 画面遷移判定
以下の条件で遷移先を決定：
- **ログイン済み & プロフィール設定済み** → ホーム画面
- **ログイン済み & プロフィール未設定** → プロフィール設定画面
- **ログアウト & 初回ユーザー** → キャラクター選択画面
- **ログアウト & 既存ユーザー** → ログイン画面

#### 5. ローカルストレージ管理
- チュートリアル完了フラグをローカルストレージで管理
- 初回ユーザーの判定（チュートリアル未完了 = 初回）

#### 6. パフォーマンス最適化
- 遷移判定が1秒以内に完了するように最適化
- スプラッシュ画面表示中にバックグラウンドで処理

---

### ゴール / 完了条件（Acceptance Criteria）

- [ ] `app/_layout.tsx` または `app/index.tsx` でスプラッシュ画面を表示（1〜3秒）
- [ ] Supabase Authのセッション確認を実施できる
- [ ] ログイン済み & プロフィール設定済み → ホーム画面へ遷移
- [ ] ログイン済み & プロフィール未設定 → プロフィール設定画面へ遷移
- [ ] ログアウト & 既存ユーザー → ログイン画面、ログアウト & 初回ユーザー → キャラクター選択画面へ遷移
- [ ] 遷移判定が1秒以内に完了する

---

### テスト観点

#### 手動テスト
- 初回起動時にチュートリアル→キャラクター選択→サインアップ→プロフィール設定→ホームの流れを確認
- ログイン後にアプリを再起動し、ホーム画面へ直接遷移することを確認
- プロフィール未設定でログイン後、プロフィール設定画面へ遷移することを確認
- ログアウト後にアプリを再起動し、ログイン画面へ遷移することを確認
- スプラッシュ画面の表示時間が1〜3秒であることを確認

#### 検証方法
1. アプリを初回起動し、初回ユーザーフローを確認
2. ログイン後、アプリを再起動し、ホーム画面へ直接遷移することを確認
3. データベースで `nickname` を削除し、アプリを再起動
4. プロフィール設定画面へ遷移することを確認
5. ログアウト後、アプリを再起動し、ログイン画面へ遷移することを確認

---

### 参考資料

- `docs/06_screen_transition_delimon.md` - 画面遷移図（初回ユーザーフロー、既存ユーザーフロー）
- [expo-splash-screen Documentation](https://docs.expo.dev/versions/latest/sdk/splash-screen/)
- [Supabase Auth Documentation](https://supabase.com/docs/reference/javascript/auth-getsession)

---

### 要確認事項

- スプラッシュ画面のデザイン（ロゴ、背景色）
- 初回ユーザーの判定方法（ローカルストレージ or DB）
- セッション確認のタイムアウト時間
