# Issue #26: プッシュ通知機能の実装

### 背景 / 目的
レベルアップ・進化可能時にプッシュ通知を送信し、ユーザーにアプリの利用を促す。

- **依存**: #13
- **ラベル**: `frontend`, `feature`

---

### スコープ / 作業項目

#### 1. expo-notificationsの導入
- `expo-notifications@0.29+` をインストール
- FCM（Firebase Cloud Messaging）との連携設定

#### 2. プッシュ通知の権限リクエスト
- アプリ起動時（またはプロフィール設定完了時）に通知権限をリクエスト
- 許可されなかった場合は通知機能を無効化

#### 3. レベルアップ通知
- レベルアップ時に「おめでとう！レベル5になりました！」通知を送信
- タップでアプリを開く

#### 4. 進化可能通知
- レベル20・50到達時に「ハコブーが進化できます！」通知を送信
- タップでアプリを開き、進化アニメーション画面へ遷移

#### 5. 通知設定のON/OFF
- 設定メニューで通知のON/OFF切り替え
- OFFの場合は通知を送信しない

#### 6. ローカル通知の実装
- Phase 1ではローカル通知（アプリ内で通知をスケジュール）を使用
- Phase 2以降でサーバー側からのプッシュ通知を検討

---

### ゴール / 完了条件（Acceptance Criteria）

- [ ] `expo-notifications@0.29+` がインストール済み
- [ ] FCM（Firebase Cloud Messaging）との連携設定完了
- [ ] レベルアップ時に「おめでとう！レベルXになりました！」通知送信
- [ ] レベル20・50到達時に「〇〇が進化できます！」通知送信
- [ ] 設定メニューで通知のON/OFF切り替え可能

---

### テスト観点

#### 手動テスト
- レベルアップ時に通知が送信されることを確認
- 通知をタップし、アプリが開くことを確認
- レベル20到達時に進化可能通知が送信されることを確認
- 設定メニューで通知をOFFにし、通知が送信されないことを確認
- 通知権限が許可されていない場合、通知が送信されないことを確認

#### 検証方法
1. アプリを起動し、通知権限をリクエスト
2. 権限を許可
3. 配送を実施し、レベルアップ
4. 通知が送信されることを確認
5. 通知をタップし、アプリが開くことを確認
6. 設定メニューで通知をOFFに切り替え
7. 再度レベルアップし、通知が送信されないことを確認

---

### 参考資料

- [expo-notifications Documentation](https://docs.expo.dev/versions/latest/sdk/notifications/)
- [Firebase Cloud Messaging Documentation](https://firebase.google.com/docs/cloud-messaging)

---

### 要確認事項

- FCMの設定（Google Cloudプロジェクト、APIキー）
- 通知のタイミング（配送終了直後、または一定時間後）
- 通知の文言・デザイン
- 通知頻度の制限（スパム防止）
