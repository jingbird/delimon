# Issue #14: プロフィール設定画面の実装

### 背景 / 目的
初回登録時にユーザーのニックネーム・生年月日・性別・業種を入力するプロフィール設定画面を実装し、ユーザー情報をデータベースに保存する。

- **依存**: #6
- **ラベル**: `frontend`, `feature`

---

### スコープ / 作業項目

#### 1. プロフィール設定画面のUI作成
- `app/(auth)/profile-setup.tsx` を作成
- React Native Paperのフォームコンポーネントを使用

#### 2. 入力フォームの実装
- ニックネーム入力（2〜20文字、特殊文字禁止）
- 生年月日入力（DatePickerコンポーネント）
- 性別選択（男性・女性・回答しない）
- 業種選択（ドロップダウン）

#### 3. リアルタイムバリデーション
- ニックネーム: 2〜20文字、特殊文字禁止、リアルタイムチェック
- 生年月日: 13歳以上、未来の日付は不可
- すべての項目が入力されていない場合は完了ボタンを無効化

#### 4. 4桁識別番号の自動生成
- `generateUniqueDisplayId(nickname: string)` 関数を実装
- 0001〜9999のランダムな4桁数字を生成
- 既に存在する組み合わせ（ニックネーム + 識別番号）がないかDBでチェック
- 重複がある場合は再生成

#### 5. プロフィール情報の保存
- 完了ボタンタップで `users` テーブルをUPDATE
- Supabase SDKを使用してデータ保存
- 保存成功後にホーム画面へ遷移

#### 6. エラーハンドリング
- ネットワークエラー時に「保存に失敗しました。もう一度お試しください」ダイアログ表示
- バリデーションエラーをフィールド下に赤文字で表示

---

### ゴール / 完了条件（Acceptance Criteria）

- [ ] `app/(auth)/profile-setup.tsx` でプロフィール設定画面のUI作成完了
- [ ] ニックネーム（2〜20文字、特殊文字禁止）、生年月日、性別、業種の入力フォーム実装完了
- [ ] リアルタイムバリデーションでエラーをフィールド下に表示できる
- [ ] 完了ボタンで4桁識別番号（0001〜9999）を自動生成し、`users` テーブルをUPDATE完了
- [ ] 保存成功後にホーム画面へ遷移できる

---

### テスト観点

#### 手動テスト
- ニックネームに特殊文字を入力した場合、エラーが表示されることを確認
- 生年月日に未来の日付を選択した場合、エラーが表示されることを確認
- すべての項目を入力した場合のみ完了ボタンが有効化されることを確認
- 完了ボタンタップ後、Supabase Dashboardで `users` テーブルが更新されていることを確認
- 識別番号が0001〜9999の範囲で4桁になっていることを確認
- 保存成功後、ホーム画面へ遷移することを確認

#### 検証方法
1. サインアップ後、プロフィール設定画面が表示されることを確認
2. ニックネームに「@@@」など特殊文字を入力し、エラーが表示されることを確認
3. すべての項目を正しく入力し、完了ボタンが有効化されることを確認
4. 完了ボタンをタップ
5. Supabase Dashboardで `users` テーブルを確認し、データが保存されていることを確認
6. ホーム画面へ遷移することを確認

---

### 参考資料

- `docs/01_requirements_delimon.md` - 要件定義（プロフィール設定仕様）
- `docs/03_database_delimon.md` - データベース設計（usersテーブル）
- `docs/05_sitemap_delimon.md` - サイトマップ（プロフィール設定画面）
- `docs/06_screen_transition_delimon.md` - 画面遷移図（初回ユーザーフロー）

---

### 要確認事項

- 業種のリスト（配送業、フードデリバリー、営業職など）
- ニックネームの禁止ワード設定の要否
- 識別番号の重複チェック方法（パフォーマンス）
- 13歳未満の利用を制限するか
